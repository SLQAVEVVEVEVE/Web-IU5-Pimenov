# üöÄ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–±–æ—Ç–µ —Å Insomnia –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏

## üì• –ß–∞—Å—Ç—å 1: –ò–º–ø–æ—Ä—Ç –∫–æ–ª–ª–µ–∫—Ü–∏–∏

### –®–∞–≥ 1: –û—Ç–∫—Ä—ã—Ç—å Insomnia

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ **Insomnia** (–∏–ª–∏ **Postman**)
2. –ï—Å–ª–∏ —ç—Ç–æ –ø–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫, —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π Workspace

### –®–∞–≥ 2: –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—é

#### –í Insomnia:

1. –ù–∞–∂–º–∏—Ç–µ **Application** ‚Üí **Preferences** (–∏–ª–∏ Ctrl+,)
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **Data**
3. –ù–∞–∂–º–∏—Ç–µ **Import Data** ‚Üí **From File**
4. –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª: `C:\SHPP\Web\Insomnia_Collection.json`
5. –ù–∞–∂–º–∏—Ç–µ **Open**

**–ò–õ–ò** (–±—ã—Å—Ç—Ä—ã–π —Å–ø–æ—Å–æ–±):

1. –ù–∞–∂–º–∏—Ç–µ **Create** ‚Üí **Import**
2. –í—ã–±–µ—Ä–∏—Ç–µ **From File**
3. –ù–∞–π–¥–∏—Ç–µ –∏ –≤—ã–±–µ—Ä–∏—Ç–µ `Insomnia_Collection.json`
4. –ù–∞–∂–º–∏—Ç–µ **Scan** ‚Üí **Import**

#### –í Postman:

1. –ù–∞–∂–º–∏—Ç–µ **Import** (–ª–µ–≤—ã–π –≤–µ—Ä—Ö–Ω–∏–π —É–≥–æ–ª)
2. –í—ã–±–µ—Ä–∏—Ç–µ **Upload Files** –∏–ª–∏ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª
3. –í—ã–±–µ—Ä–∏—Ç–µ `Insomnia_Collection.json`
4. –ù–∞–∂–º–∏—Ç–µ **Import**

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –í—ã —É–≤–∏–¥–∏—Ç–µ –ø–∞–ø–∫—É —Å 12 –∑–∞–ø—Ä–æ—Å–∞–º–∏

**üì∏ –°–∫—Ä–∏–Ω—à–æ—Ç –¥–ª—è –¢–ó**: –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–æ–ª–ª–µ–∫—Ü–∏—è –≤ Insomnia

---

## üéØ –ß–∞—Å—Ç—å 2: –ü–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤

### üìã –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏:

```
1. Sign In (User)
2. Sign In (Moderator)
3. GET Requests (Guest) ‚Üí 401
4. GET Requests (User) ‚Üí Own Only
5. Complete Request (User) ‚Üí 403
6. Complete Request (Moderator) ‚Üí 200
7. GET Requests (Moderator) ‚Üí All
8. GET Drafts (Moderator) ‚Üí All Drafts ‚ú® NEW
9. Sign Out (Blacklist Token)
10. GET with Blacklisted Token ‚Üí 401
EXTRA: GET Current User
EXTRA: GET Beams
```

---

## üîë –ß–∞—Å—Ç—å 3: –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –±–∞–∑–æ–≤—ã–π –¥–æ—Å—Ç—É–ø

#### –ó–∞–ø—Ä–æ—Å 3: GET Requests (Guest) ‚Üí 401

**–¶–µ–ª—å**: –ü–æ–∫–∞–∑–∞—Ç—å, —á—Ç–æ –±–µ–∑ —Ç–æ–∫–µ–Ω–∞ –¥–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω

1. –í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–ø—Ä–æ—Å **"3. GET Requests (Guest) ‚Üí 401"**
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ URL: `http://localhost:3000/api/beam_deflections`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Headers: –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø—É—Å—Ç–æ (–ù–ï–¢ Authorization)
4. –ù–∞–∂–º–∏—Ç–µ **Send**

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
```
Status: 401 Unauthorized
Body: {
  "error": "Missing token" (–∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ–µ)
}
```

**üì∏ –°–∫—Ä–∏–Ω—à–æ—Ç #4 –¥–ª—è –¢–ó**: 401 Unauthorized –¥–ª—è –≥–æ—Å—Ç—è

**–ß—Ç–æ –ø–æ–∫–∞–∑–∞—Ç—å**:
- ‚úÖ URL –≤ –∞–¥—Ä–µ—Å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ
- ‚úÖ HTTP –º–µ—Ç–æ–¥ GET
- ‚úÖ Status 401 –∫—Ä–∞—Å–Ω—ã–º —Ü–≤–µ—Ç–æ–º
- ‚úÖ Response body —Å –æ—à–∏–±–∫–æ–π
- ‚úÖ –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Authorization header

---

#### –ó–∞–ø—Ä–æ—Å 1: Sign In (User)

**–¶–µ–ª—å**: –ü–æ–ª—É—á–∏—Ç—å JWT —Ç–æ–∫–µ–Ω –¥–ª—è –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

1. –í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–ø—Ä–æ—Å **"1. Sign In (User)"**
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ URL: `http://localhost:3000/api/auth/sign_in`
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **Body**
4. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤—ã–±—Ä–∞–Ω **JSON**
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ:
   ```json
   {
     "email": "user@demo.com",
     "password": "password123"
   }
   ```
6. –ù–∞–∂–º–∏—Ç–µ **Send**

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
```
Status: 200 OK
Body: {
  "token": "eyJhbGciOiJIUzI1NiJ9...",
  "user": {
    "id": 39,
    "email": "user@demo.com",
    "moderator": false
  }
}
```

**–í–ê–ñ–ù–û**: –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ `token` –∏–∑ Response!

**üì∏ –°–∫—Ä–∏–Ω—à–æ—Ç –¥–ª—è —Å–ø—Ä–∞–≤–∫–∏**: –£—Å–ø–µ—à–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

**–ß—Ç–æ –ø–æ–∫–∞–∑–∞—Ç—å**:
- ‚úÖ Request body —Å credentials
- ‚úÖ Status 200 OK
- ‚úÖ Response —Å —Ç–æ–∫–µ–Ω–æ–º –∏ –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ moderator: false

---

#### –ó–∞–ø—Ä–æ—Å 4: GET Requests (User) ‚Üí Own Only

**–¶–µ–ª—å**: –ü–æ–∫–∞–∑–∞—Ç—å, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –∑–∞—è–≤–∫–∏

1. –í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–ø—Ä–æ—Å **"4. GET Requests (User) ‚Üí Own Only"**
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **Headers**
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Authorization header (—Ç–æ–∫–µ–Ω —É–∂–µ –≤—Å—Ç—Ä–æ–µ–Ω):
   ```
   Authorization: Bearer eyJhbGciOiJIUzI1NiJ9...
   ```
4. **–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û**: –ó–∞–º–µ–Ω–∏—Ç–µ —Ç–æ–∫–µ–Ω –Ω–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–∑ –∑–∞–ø—Ä–æ—Å–∞ #1
5. –ù–∞–∂–º–∏—Ç–µ **Send**

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
```
Status: 200 OK
Body: {
  "beam_deflections": [
    {
      "id": 52,
      "status": "formed",
      "creator_login": "user@demo.com",
      ...
    },
    {
      "id": 53,
      "status": "completed",
      "creator_login": "user@demo.com",
      ...
    }
  ],
  "meta": {
    "total_count": 2
  }
}
```

**–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ**:
- ‚úÖ –í—Å–µ –∑–∞—è–≤–∫–∏ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç `user@demo.com`
- ‚úÖ –ù–ï –≤–∫–ª—é—á–∞–µ—Ç –¥—Ä–∞—Ñ—Ç—ã (—Ç–æ–ª—å–∫–æ formed/completed)
- ‚úÖ total_count = 2 (–∏–ª–∏ –¥—Ä—É–≥–æ–µ —á–∏—Å–ª–æ)

**üì∏ –°–∫—Ä–∏–Ω—à–æ—Ç #5 –¥–ª—è –¢–ó**: –°–ø–∏—Å–æ–∫ —Å–≤–æ–∏—Ö –∑–∞—è–≤–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–ß—Ç–æ –ø–æ–∫–∞–∑–∞—Ç—å**:
- ‚úÖ Authorization header —Å —Ç–æ–∫–µ–Ω–æ–º
- ‚úÖ Status 200 OK
- ‚úÖ –°–ø–∏—Å–æ–∫ –∑–∞—è–≤–æ–∫ —Ç–æ–ª—å–∫–æ –æ—Ç user@demo.com
- ‚úÖ –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥—Ä–∞—Ñ—Ç–æ–≤ –≤ —Å–ø–∏—Å–∫–µ

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–∏—Ç—å –∑–∞—è–≤–∫—É –æ–±—ã—á–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º

#### –ó–∞–ø—Ä–æ—Å 5: Complete Request (User) ‚Üí 403

**–¶–µ–ª—å**: –ü–æ–∫–∞–∑–∞—Ç—å, —á—Ç–æ –æ–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ù–ï –º–æ–∂–µ—Ç –∑–∞–≤–µ—Ä—à–∏—Ç—å –∑–∞—è–≤–∫—É

1. –í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–ø—Ä–æ—Å **"5. Complete Request (User) ‚Üí 403"**
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ URL: `http://localhost:3000/api/beam_deflections/52/complete`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –º–µ—Ç–æ–¥: **PUT**
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Headers: Authorization —Å user token
5. –ù–∞–∂–º–∏—Ç–µ **Send**

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
```
Status: 403 Forbidden
Body: {
  "error": "Moderator access required"
}
```

**üì∏ –°–∫—Ä–∏–Ω—à–æ—Ç #6 –¥–ª—è –¢–ó**: 403 Forbidden –¥–ª—è –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–ß—Ç–æ –ø–æ–∫–∞–∑–∞—Ç—å**:
- ‚úÖ URL —Å /52/complete
- ‚úÖ HTTP –º–µ—Ç–æ–¥ PUT
- ‚úÖ Authorization header (user token)
- ‚úÖ Status 403 Forbidden
- ‚úÖ Error message –ø—Ä–æ moderator

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä –∑–∞–≤–µ—Ä—à–∞–µ—Ç –∑–∞—è–≤–∫—É

#### –ó–∞–ø—Ä–æ—Å 2: Sign In (Moderator)

**–¶–µ–ª—å**: –ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞

1. –í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–ø—Ä–æ—Å **"2. Sign In (Moderator)"**
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Body:
   ```json
   {
     "email": "moderator@demo.com",
     "password": "password123"
   }
   ```
3. –ù–∞–∂–º–∏—Ç–µ **Send**

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
```
Status: 200 OK
Body: {
  "token": "eyJhbGciOiJIUzI1NiJ9...",
  "user": {
    "id": 40,
    "email": "moderator@demo.com",
    "moderator": true  ‚Üê –í–ê–ñ–ù–û!
  }
}
```

**–í–ê–ñ–ù–û**: –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞!

---

#### –ó–∞–ø—Ä–æ—Å 6: Complete Request (Moderator) ‚Üí 200

**–¶–µ–ª—å**: –ü–æ–∫–∞–∑–∞—Ç—å —É—Å–ø–µ—à–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∑–∞—è–≤–∫–∏ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–æ–º

1. –í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–ø—Ä–æ—Å **"6. Complete Request (Moderator) ‚Üí 200"**
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ URL: `http://localhost:3000/api/beam_deflections/52/complete`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Headers: Authorization —Å moderator token
4. **–í–ê–ñ–ù–û**: –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ ID=52 –µ—â—ë –Ω–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ (status: formed)
5. –ù–∞–∂–º–∏—Ç–µ **Send**

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
```
Status: 200 OK
Body: {
  "id": 52,
  "status": "completed",  ‚Üê –∏–∑–º–µ–Ω–∏–ª—Å—è!
  "completed_at": "2025-01-29T...",  ‚Üê –∑–∞–ø–æ–ª–Ω–∏–ª—Å—è!
  "moderator_login": "moderator@demo.com",  ‚Üê –∑–∞–ø–æ–ª–Ω–∏–ª—Å—è!
  "result_deflection_mm": 2.5,  ‚Üê —Ä–∞—Å—Å—á–∏—Ç–∞–ª—Å—è!
  "within_norm": true,
  ...
}
```

**üì∏ –°–∫—Ä–∏–Ω—à–æ—Ç #7 –¥–ª—è –¢–ó**: –£—Å–ø–µ—à–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∑–∞—è–≤–∫–∏ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–æ–º

**–ß—Ç–æ –ø–æ–∫–∞–∑–∞—Ç—å**:
- ‚úÖ URL —Å /52/complete
- ‚úÖ HTTP –º–µ—Ç–æ–¥ PUT
- ‚úÖ Authorization header (moderator token)
- ‚úÖ Status 200 OK
- ‚úÖ Response —Å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –ø–æ–ª—è–º–∏:
  - status: "completed"
  - completed_at: –∑–∞–ø–æ–ª–Ω–µ–Ω
  - moderator_login: "moderator@demo.com"
  - result_deflection_mm: —á–∏—Å–ª–æ
  - within_norm: true/false

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä –≤–∏–¥–∏—Ç –≤—Å–µ –∑–∞—è–≤–∫–∏

#### –ó–∞–ø—Ä–æ—Å 7: GET Requests (Moderator) ‚Üí All

**–¶–µ–ª—å**: –ü–æ–∫–∞–∑–∞—Ç—å, —á—Ç–æ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä –≤–∏–¥–∏—Ç –í–°–ï –∑–∞—è–≤–∫–∏ (–≤–∫–ª—é—á–∞—è —á—É–∂–∏–µ)

1. –í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–ø—Ä–æ—Å **"7. GET Requests (Moderator) ‚Üí All"**
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Headers: Authorization —Å moderator token
3. –ù–∞–∂–º–∏—Ç–µ **Send**

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
```
Status: 200 OK
Body: {
  "beam_deflections": [
    {
      "id": 52,
      "creator_login": "user@demo.com",  ‚Üê —á—É–∂–∞—è –∑–∞—è–≤–∫–∞!
      "status": "completed",
      ...
    },
    {
      "id": 25,
      "creator_login": "demo@local",  ‚Üê –µ—â—ë —á—É–∂–∞—è!
      ...
    },
    ...
  ],
  "meta": {
    "total_count": 4  ‚Üê –±–æ–ª—å—à–µ —á–µ–º —É user!
  }
}
```

**–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ**:
- ‚úÖ –ó–∞—è–≤–∫–∏ –æ—Ç –†–ê–ó–ù–´–• –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–Ω–µ —Ç–æ–ª—å–∫–æ moderator@demo.com)
- ‚úÖ total_count –±–æ–ª—å—à–µ, —á–µ–º –±—ã–ª–æ —É –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –ù–ï –≤–∫–ª—é—á–∞–µ—Ç –¥—Ä–∞—Ñ—Ç—ã (—Ç–æ–ª—å–∫–æ formed/completed/rejected)

**üì∏ –°–∫—Ä–∏–Ω—à–æ—Ç #8 –¥–ª—è –¢–ó**: –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä –≤–∏–¥–∏—Ç –≤—Å–µ –∑–∞—è–≤–∫–∏

**–ß—Ç–æ –ø–æ–∫–∞–∑–∞—Ç—å**:
- ‚úÖ Authorization header (moderator token)
- ‚úÖ Status 200 OK
- ‚úÖ –ó–∞—è–≤–∫–∏ –æ—Ç –†–ê–ó–ù–´–• creator_login
- ‚úÖ total_count > 2

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 5: ‚ú® –ù–û–í–û–ï - –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä –≤–∏–¥–∏—Ç –≤—Å–µ –¥—Ä–∞—Ñ—Ç—ã

#### –ó–∞–ø—Ä–æ—Å 8: GET Drafts (Moderator) ‚Üí All Drafts ‚ú® NEW

**–¶–µ–ª—å**: –ü–æ–∫–∞–∑–∞—Ç—å –ù–û–í–£–Æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å - –ø—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –¥—Ä–∞—Ñ—Ç–æ–≤

1. –í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–ø—Ä–æ—Å **"8. GET Drafts (Moderator) ‚Üí All Drafts ‚ú® NEW"**
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ URL: `http://localhost:3000/api/beam_deflections?status=draft`
3. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä `?status=draft`
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Headers: Authorization —Å moderator token
5. –ù–∞–∂–º–∏—Ç–µ **Send**

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
```
Status: 200 OK
Body: {
  "beam_deflections": [
    {
      "id": 23,
      "status": "draft",
      "creator_login": "dev@example.com",  ‚Üê —á—É–∂–æ–π –¥—Ä–∞—Ñ—Ç!
      ...
    },
    {
      "id": 27,
      "status": "draft",
      "creator_login": "user1@test.com",  ‚Üê –µ—â—ë —á—É–∂–æ–π!
      ...
    },
    {
      "id": 28,
      "status": "draft",
      "creator_login": "user2@test.com",  ‚Üê –∏ –µ—â—ë!
      ...
    },
    {
      "id": 51,
      "status": "draft",
      "creator_login": "user@demo.com",  ‚Üê –∏ –æ—Ç demo user
      ...
    }
  ],
  "meta": {
    "total_count": 4
  }
}
```

**–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ**:
- ‚úÖ –í–°–ï –∑–∞—è–≤–∫–∏ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "draft"
- ‚úÖ –û—Ç –†–ê–ó–ù–´–• –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–Ω–µ —Ç–æ–ª—å–∫–æ –æ—Ç –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞)
- ‚úÖ –≠—Ç–æ –ù–û–í–ê–Ø —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å!

**üì∏ –°–∫—Ä–∏–Ω—à–æ—Ç #9 –¥–ª—è –¢–ó**: ‚ú® –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä –≤–∏–¥–∏—Ç –≤—Å–µ –¥—Ä–∞—Ñ—Ç—ã (–ù–û–í–ê–Ø –§–£–ù–ö–¶–ò–Ø)

**–ß—Ç–æ –ø–æ–∫–∞–∑–∞—Ç—å**:
- ‚úÖ URL —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º `?status=draft`
- ‚úÖ Authorization header (moderator token)
- ‚úÖ Status 200 OK
- ‚úÖ Response —Å –¥—Ä–∞—Ñ—Ç–∞–º–∏ –æ—Ç –†–ê–ó–ù–´–• –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –í–°–ï –∏–º–µ—é—Ç status: "draft"
- ‚úÖ –ù–∞–¥–ø–∏—Å—å "‚ú® NEW" –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏ –∑–∞–ø—Ä–æ—Å–∞

**–í–ê–ñ–ù–û**: –≠—Ç–æ –∫–ª—é—á–µ–≤–æ–π —Å–∫—Ä–∏–Ω—à–æ—Ç –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏!

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 6: JWT Blacklist (Sign Out)

#### –ó–∞–ø—Ä–æ—Å 9: Sign Out (Blacklist Token)

**–¶–µ–ª—å**: –ü–æ–∫–∞–∑–∞—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –≤ blacklist

**–ü–û–î–ì–û–¢–û–í–ö–ê**:
1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–∫–µ–Ω –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∏–∑ –∑–∞–ø—Ä–æ—Å–∞ #1)
2. –ò–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —á–µ—Ä–µ–∑ –∑–∞–ø—Ä–æ—Å #1

**–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ**:
1. –í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–ø—Ä–æ—Å **"9. Sign Out (Blacklist Token)"**
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **Headers**
3. **–ó–ê–ú–ï–ù–ò–¢–ï** `<REPLACE_WITH_TOKEN>` –Ω–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω
   ```
   Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjozOSwiZXhwIjoxNzY0NTI5NTUwfQ...
   ```
4. –ù–∞–∂–º–∏—Ç–µ **Send**

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
```
Status: 204 No Content
Body: (–ø—É—Å—Ç–æ)
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ CMD**:
–û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
```bash
docker-compose exec redis redis-cli KEYS "jwt:blacklist:*"
```

–î–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è **–Ω–æ–≤—ã–π –∫–ª—é—á**!

**üì∏ –°–∫—Ä–∏–Ω—à–æ—Ç #13 –¥–ª—è –¢–ó**: –ù–æ–≤—ã–π blacklist –∫–ª—é—á –ø–æ—Å–ª–µ sign_out

---

#### –ó–∞–ø—Ä–æ—Å 10: GET with Blacklisted Token ‚Üí 401

**–¶–µ–ª—å**: –ü–æ–∫–∞–∑–∞—Ç—å, —á—Ç–æ blacklisted —Ç–æ–∫–µ–Ω –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. –í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–ø—Ä–æ—Å **"10. GET with Blacklisted Token ‚Üí 401"**
2. **–ó–ê–ú–ï–ù–ò–¢–ï** `<REPLACE_WITH_BLACKLISTED_TOKEN>` –Ω–∞ —Ç–æ–∫–µ–Ω –∏–∑ —à–∞–≥–∞ #9
3. –ù–∞–∂–º–∏—Ç–µ **Send**

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
```
Status: 401 Unauthorized
Body: {
  "error": "Token has been revoked" (–∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ–µ)
}
```

**üì∏ –°–∫—Ä–∏–Ω—à–æ—Ç #14 –¥–ª—è –¢–ó**: 401 –¥–ª—è blacklisted —Ç–æ–∫–µ–Ω–∞

**–ß—Ç–æ –ø–æ–∫–∞–∑–∞—Ç—å**:
- ‚úÖ Authorization header —Å blacklisted —Ç–æ–∫–µ–Ω–æ–º
- ‚úÖ Status 401 Unauthorized
- ‚úÖ Error message –ø—Ä–æ revoked token

---

## üì∏ –ß–∞—Å—Ç—å 4: –°–∫—Ä–∏–Ω—à–æ—Ç—ã –¥–ª—è –¢–ó (–∏–∑ Insomnia)

### –°–ø–∏—Å–æ–∫ —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤ –∏–∑ Insomnia:

| # | –ù–∞–∑–≤–∞–Ω–∏–µ | –ó–∞–ø—Ä–æ—Å | –ß—Ç–æ –ø–æ–∫–∞–∑–∞—Ç—å |
|---|----------|--------|--------------|
| 4 | 401 –¥–ª—è –≥–æ—Å—Ç—è | #3 | GET –±–µ–∑ —Ç–æ–∫–µ–Ω–∞ ‚Üí 401 |
| 5 | –°–≤–æ–∏ –∑–∞—è–≤–∫–∏ | #4 | GET —Å user ‚Üí —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ |
| 6 | 403 –¥–ª—è user | #5 | PUT complete ‚Üí 403 |
| 7 | 200 –¥–ª—è moderator | #6 | PUT complete ‚Üí 200 ‚úÖ |
| 8 | –í—Å–µ –∑–∞—è–≤–∫–∏ (mod) | #7 | GET ‚Üí –≤—Å–µ –∑–∞—è–≤–∫–∏ |
| 9 | ‚ú® –í—Å–µ –¥—Ä–∞—Ñ—Ç—ã (mod) | #8 | GET ?status=draft ‚Üí –¥—Ä–∞—Ñ—Ç—ã |
| 13 | –ù–æ–≤—ã–π blacklist | #9 | –ü–æ—Å–ª–µ sign_out |
| 14 | 401 –¥–ª—è blacklisted | #10 | GET —Å revoked token |

---

## üéØ –ß–∞—Å—Ç—å 5: –°–æ–≤–µ—Ç—ã –ø–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏

### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

1. **–ü–µ—Ä–µ–¥ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–µ–π**:
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å–µ—Ä–≤–∏—Å—ã –∑–∞–ø—É—â–µ–Ω—ã: `docker-compose ps`
   - –ü–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ –¥–∞–Ω–Ω—ã–µ: `docker-compose exec web bin/rails runner prepare_demo.rb`
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å: `docker-compose exec web bin/rails runner verify_demo.rb`

2. **–û—Ç–∫—Ä–æ–π—Ç–µ –∑–∞—Ä–∞–Ω–µ–µ**:
   - Insomnia —Å –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∫–æ–ª–ª–µ–∫—Ü–∏–µ–π
   - –ö–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É –¥–ª—è Redis
   - Swagger UI (http://localhost:3000/api-docs)

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ ID –∑–∞—è–≤–æ–∫**:
   ```bash
   docker-compose exec web bin/rails runner "puts BeamDeflection.formed.first.id"
   ```
   –ï—Å–ª–∏ ID –Ω–µ 52, –∑–∞–º–µ–Ω–∏—Ç–µ –≤ –∑–∞–ø—Ä–æ—Å–∞—Ö #5 –∏ #6

### –í–æ –≤—Ä–µ–º—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏

1. **–ü–æ–∫–∞–∑—ã–≤–∞–π—Ç–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ**:
   - –°–Ω–∞—á–∞–ª–∞ –≥–æ—Å—Ç—å (401)
   - –ü–æ—Ç–æ–º user (—Å–≤–æ–∏ –∑–∞—è–≤–∫–∏)
   - –ü–æ—Ç–æ–º user –ø—ã—Ç–∞–µ—Ç—Å—è complete (403)
   - –ü–æ—Ç–æ–º moderator complete (200)
   - –ü–æ—Ç–æ–º moderator –≤–∏–¥–∏—Ç –≤—Å–µ
   - ‚ú® **–ù–û–í–û–ï**: moderator –≤–∏–¥–∏—Ç –¥—Ä–∞—Ñ—Ç—ã

2. **–ö–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ**:
   - "–û–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –∑–∞—è–≤–∫–∏"
   - "–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –∑–∞–≤–µ—Ä—à–∏—Ç—å –∑–∞—è–≤–∫—É"
   - ‚ú® "**–ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è**: –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –í–°–ï –¥—Ä–∞—Ñ—Ç—ã –æ—Ç –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"

3. **–ü–æ–∫–∞–∑—ã–≤–∞–π—Ç–µ Response**:
   - Status code (—Ü–≤–µ—Ç–Ω–æ–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä)
   - Response body (—Ä–∞–∑–≤–µ—Ä–Ω–∏—Ç–µ –Ω—É–∂–Ω—ã–µ –ø–æ–ª—è)
   - Headers (–æ—Å–æ–±–µ–Ω–Ω–æ Authorization)

### –ü–æ—Å–ª–µ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏

1. **–û—á–∏—Å—Ç–∫–∞** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
   ```bash
   docker-compose exec web bin/rails runner prepare_demo.rb
   ```

2. **–°–±—Ä–æ—Å Redis** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
   ```bash
   docker-compose exec redis redis-cli FLUSHDB
   ```

---

## üîß –ß–∞—Å—Ç—å 6: Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: 401 –¥–ª—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

**–†–µ—à–µ–Ω–∏–µ**:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ç–æ–∫–µ–Ω—ã –∞–∫—Ç—É–∞–ª—å–Ω—ã
2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–ø—Ä–æ—Å #1 –∏–ª–∏ #2 –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ —Ç–æ–∫–µ–Ω–∞
3. –ó–∞–º–µ–Ω–∏—Ç–µ —Ç–æ–∫–µ–Ω –≤ Headers

### –ü—Ä–æ–±–ª–µ–º–∞: 404 Not Found –¥–ª—è ID=52

**–†–µ—à–µ–Ω–∏–µ**:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã–π ID:
   ```bash
   docker-compose exec web bin/rails runner "puts BeamDeflection.formed.first.id"
   ```
2. –ó–∞–º–µ–Ω–∏—Ç–µ ID –≤ URL –∑–∞–ø—Ä–æ—Å–æ–≤ #5 –∏ #6

### –ü—Ä–æ–±–ª–µ–º–∞: –ü—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ –¥—Ä–∞—Ñ—Ç–æ–≤ (–∑–∞–ø—Ä–æ—Å #8)

**–†–µ—à–µ–Ω–∏–µ**:
1. –ü–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ –¥–∞–Ω–Ω—ã–µ:
   ```bash
   docker-compose exec web bin/rails runner prepare_demo.rb
   ```
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ:
   ```bash
   docker-compose exec web bin/rails runner "puts BeamDeflection.draft.count"
   ```

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ –≤–∏–¥–Ω–æ –Ω–æ–≤—ã—Ö blacklist –∫–ª—é—á–µ–π

**–†–µ—à–µ–Ω–∏–µ**:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Redis:
   ```bash
   docker-compose exec redis redis-cli PING
   ```
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–ª—é—á–∏:
   ```bash
   docker-compose exec redis redis-cli KEYS "*"
   ```

---

## üìã –ß–∞—Å—Ç—å 7: –ö—Ä–∞—Ç–∫–∏–π —á–µ–∫–ª–∏—Å—Ç

- [ ] –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å `Insomnia_Collection.json`
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Å–µ—Ä–≤–∏—Å—ã –∑–∞–ø—É—â–µ–Ω—ã
- [ ] –ó–∞–ø—Ä–æ—Å #3: GET –±–µ–∑ —Ç–æ–∫–µ–Ω–∞ ‚Üí 401 üì∏
- [ ] –ó–∞–ø—Ä–æ—Å #1: Sign in (user)
- [ ] –ó–∞–ø—Ä–æ—Å #4: GET —Å user ‚Üí —Å–≤–æ–∏ –∑–∞—è–≤–∫–∏ üì∏
- [ ] –ó–∞–ø—Ä–æ—Å #5: Complete —Å user ‚Üí 403 üì∏
- [ ] –ó–∞–ø—Ä–æ—Å #2: Sign in (moderator)
- [ ] –ó–∞–ø—Ä–æ—Å #6: Complete —Å moderator ‚Üí 200 üì∏
- [ ] –ó–∞–ø—Ä–æ—Å #7: GET –≤—Å–µ –∑–∞—è–≤–∫–∏ (moderator) üì∏
- [ ] –ó–∞–ø—Ä–æ—Å #8: ‚ú® GET –¥—Ä–∞—Ñ—Ç—ã (moderator) ‚Üí –ù–û–í–û–ï üì∏
- [ ] –ó–∞–ø—Ä–æ—Å #9: Sign out (–ø–æ–ª—É—á–∏—Ç—å –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω —Å–Ω–∞—á–∞–ª–∞)
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Redis blacklist üì∏
- [ ] –ó–∞–ø—Ä–æ—Å #10: GET —Å blacklisted ‚Üí 401 üì∏

---

## üéâ –ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä—å —É –≤–∞—Å –µ—Å—Ç—å –ø–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–±–æ—Ç–µ —Å Insomnia –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞.

**–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã**:
- ‚úÖ 12 –≥–æ—Ç–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ –¢–æ–∫–µ–Ω—ã —É–∂–µ –≤—Å—Ç—Ä–æ–µ–Ω—ã
- ‚úÖ –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —è—Å–Ω–∞
- ‚ú® **–ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è** (#8) –≤—ã–¥–µ–ª–µ–Ω–∞
- üì∏ 8 —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤ –∏–∑ Insomnia –¥–ª—è –¢–ó

–£–¥–∞—á–Ω–æ–π –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏! üöÄ
