<% @load_forecast.load_forecast_beam_types.includes(:beam_type).each do |item| %>
  <% is_valid = item.beam_type.present? %>
  <% beam_type = item.beam_type if is_valid %>
  
  <li class="cart-item <%= 'cart-item--invalid' unless is_valid %>">
    <div class="cart-item__image">
      <%= is_valid ? 'üì¶' : '‚ùì' %>
    </div>
    
    <div class="cart-item__details">
      <h3 class="cart-item__title">
        <%= is_valid ? beam_type.name : "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø –±–∞–ª–∫–∏ ##{item.beam_type_id}" %>
      </h3>
      
      <div class="cart-item__meta">
        <% if is_valid %>
          <span>–î–ª–∏–Ω–∞: <strong><%= item.length_m %></strong> –º</span>
          <span>–ù–∞–≥—Ä—É–∑–∫–∞: <strong><%= item.load_kn_m %></strong> –∫–ù/–º</span>
          <span>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: <strong class="cart-item__quantity"><%= item.quantity %></strong> —à—Ç.</span>
        <% else %>
          <span>–≠—Ç–∞ –ø–æ–∑–∏—Ü–∏—è –±–æ–ª—å—à–µ –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞</span>
        <% end %>
      </div>
    </div>
    
    <div class="cart-item__actions">
      <% if is_valid && beam_type.respond_to?(:price) && beam_type.price.present? %>
        <span class="cart-item__price">
          <%= number_to_currency(item.quantity * beam_type.price.to_f, unit: '‚ÇΩ', format: "%n %u") %>
        </span>
      <% end %>
      
      <%= link_to '‚úï', load_forecast_beam_type_path(@load_forecast, item),
          data: { 
            turbo_method: :delete,
            turbo_confirm: '–£–¥–∞–ª–∏—Ç—å –ø–æ–∑–∏—Ü–∏—é –∏–∑ –∑–∞—è–≤–∫–∏?'
          },
          class: 'cart-item__remove',
          title: '–£–¥–∞–ª–∏—Ç—å' %>
    </div>
  </li>
<% end %>
